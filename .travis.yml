language: rust
os:
    - linux
    - osx
rust:
    - stable
    - beta
matrix:
    allow_failures: beta
    fast_finish: true
before_script:
    - rustup toolchain install stable
    - rustup component add rustfmt --toolchain stable
    - rustup component list --toolchain stable
    - rustup show
script:
    - cargo +stable fmt --all -- --check
    - cargo build --release
    - cargo build
    - RUST_BACKTRACE=1 cargo test

